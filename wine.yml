# Modified from org.winehq.Wine, to save space, as only a wow64 wine is required.
name: modules
buildsystem: simple
build-commands: []
modules:
  - name: wine
    build-options:
      append-path: /usr/lib/sdk/mingw-w64/bin
      env:
        LIBDIR: lib
    config-opts:
      - --libdir=/app/lib
      - --disable-win16
      - --disable-tests
      - --with-x
      - --with-wayland
      - --with-pulse
      - --with-dbus
      - --without-oss
      - --enable-win64
      - --with-mingw=ccache x86_64-w64-mingw64-gcc
    install-rule: install-lib
    make-install-args:
      - LDCONFIG=/bin/true
      - UPDATE_DESKTOP_DATABASE=/bin/true
      - INSTALL_PROGRAM_FLAGS=-s
    sources:
      - type: archive
        url: https://gitlab.winehq.org/wine/wine/-/archive/wine-10.16/wine-wine-10.16.tar.gz
        sha256: 90af76e2b1611a017289290202f34f0f53f7bca080b46df3f10efe0615cc8668
        
      - type: archive
        url: https://gitlab.winehq.org/wine/wine-staging/-/archive/v10.16/wine-staging-v10.16.tar.gz
        sha256: 58d6ab40513e81a9ac66ae6ea050f79210dc34be2a22b1bd4d3161d77d6cea3a
      - type: shell
        commands:
          - staging/patchinstall.py --destdir=. --all
      - type: patch
        paths:
          - patches/wine/xfixes-hide-cursor.patch
          - patches/wine/dont-load-bitmap-only-ttf-fonts.patch
#    modules:
#      - name: libusb
#        sources:
#          - type: archive
#            url: https://github.com/libusb/libusb/releases/download/v1.0.29/libusb-1.0.29.tar.bz2
#            sha256: 5977fc950f8d1395ccea9bd48c06b3f808fd3c2c961b44b0c2e6e29fc3a70a85
